# Руководство по запуску сервисов в Docker

## Запуск сервисов в Docker

Для запуска сервисов аутентификации и чата в Docker контейнерах выполните следующую команду в корневой директории проекта:

```bash
docker-compose up -d
```

Эта команда запустит оба сервиса в фоновом режиме:
- **auth-service** - сервис аутентификации на порту 50051
- **chat-service** - сервис чата на порту 50052

## Подключение клиента к удаленным сервисам

Для подключения клиента к сервисам, запущенным на удаленном сервере, необходимо изменить файл `.env` в директории `chat-client`:

```
CHAT_AUTH_SERVICE_ADDR=<IP-адрес-сервера>:50051
CHAT_SERVICE_ADDR=<IP-адрес-сервера>:50052
```

Замените `<IP-адрес-сервера>` на реальный IP-адрес вашего удаленного сервера, где запущены контейнеры.

## Запуск клиента локально

После настройки переменных окружения, запустите клиент локально:

```bash
cd chat-client
go run main.go
```

## Проверка работоспособности

Для проверки доступности сервисов можно использовать следующие команды:

```bash
# Проверка сервиса аутентификации
grpcurl -plaintext <IP-адрес-сервера>:50051 list

# Проверка сервиса чата
grpcurl -plaintext <IP-адрес-сервера>:50052 list
```

## Остановка сервисов

Для остановки сервисов выполните:

```bash
docker-compose down
```

Для остановки сервисов и удаления томов с данными:

```bash
docker-compose down -v
```

## Структура Docker-конфигурации

- **docker-compose.yml** - основной файл конфигурации, определяющий сервисы, сети и тома
- **auth-service/Dockerfile** - инструкции по сборке образа для сервиса аутентификации
- **chat-service/Dockerfile** - инструкции по сборке образа для сервиса чата

## Особенности конфигурации

- Сервисы используют постоянные тома для хранения баз данных SQLite
- Настроена внутренняя сеть для взаимодействия между сервисами
- Порты сервисов проброшены на хост-машину для доступа извне
- Сервис чата настроен на подключение к сервису аутентификации внутри Docker-сети